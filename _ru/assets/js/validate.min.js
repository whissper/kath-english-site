function onloadCallback(){grecaptcha.render("grelem",{sitekey:"6LfFHhEUAAAAAIHSvYBhfCvQHgtz9qhiaHOfkS43",callback:"recaptchaIsChecked","expired-callback":"recaptchaExpired"})}function recaptchaIsChecked(){const e=document.getElementById("send");e.setAttribute("active","true"),e.setAttribute("data-toggle","modal"),e.setAttribute("data-target","#windowModal"),e.classList.remove("disabled")}function recaptchaExpired(){const e=document.getElementById("send");e.setAttribute("active","false"),e.setAttribute("data-toggle",""),e.setAttribute("data-target",""),e.classList.add("disabled")}function showCharLength(){let e=255-document.getElementById("messageTextArea").value.length;e=e>0?e:0,document.getElementById("countTA").value="Символов осталось: "+e}function resetForm(){if(document.querySelector("#sendStatusField .alert").classList.contains("alert-success")){grecaptcha.reset(),document.getElementById("nameInputAddress").value="",document.getElementById("mailInputAddress").value="",document.getElementById("subjectInputAddress").value="",document.getElementById("messageTextArea").value="",showCharLength();const e=document.getElementById("send");e.setAttribute("active","false"),e.setAttribute("data-toggle",""),e.setAttribute("data-target",""),e.classList.add("disabled")}}function allFieldsAreValid(){var e=!1,t=$("div.php-email-form").find(".form-group"),a=!1,n=/^[^\s()<>@,;:\/]+@\w[\w\.-]+\.[a-z]{2,}$/i;return t.children("input").each((function(){var e=$(this),t=e.attr("data-rule");if(void 0!==t){var d=!1,s=t.indexOf(":",0);if(s>=0){var r=t.substr(s+1,t.length);t=t.substr(0,s)}else t=t.substr(s+1,t.length);switch(t){case"required":""===e.val()&&(a=d=!0);break;case"minlen":e.val().length<parseInt(r)&&(a=d=!0);break;case"email":n.test(e.val())||(a=d=!0);break;case"checked":e.is(":checked")||(a=d=!0);break;case"regexp":(r=new RegExp(r)).test(e.val())||(a=d=!0)}e.next(".validate").html(d?void 0!==e.attr("data-msg")?e.attr("data-msg"):"wrong Input":"").show("blind")}})),t.children("textarea").each((function(){var e=$(this),t=e.attr("data-rule");if(void 0!==t){var n=!1,d=t.indexOf(":",0);if(d>=0){var s=t.substr(d+1,t.length);t=t.substr(0,d)}else t=t.substr(d+1,t.length);switch(t){case"required":""===e.val()&&(a=n=!0);break;case"minlen":e.val().length<parseInt(s)&&(a=n=!0)}e.next(".validate").html(n?null!=e.attr("data-msg")?e.attr("data-msg"):"wrong Input":"").show("blind")}})),a||(e=!0),e}function doAJAX(e){const t=function(){};let a=e||{};a.method=void 0===a.method?"POST":a.method,a.url=void 0===a.url?"":a.url,a.data=void 0===a.data?{}:a.data,a.dataType=void 0===a.dataType?"text":a.dataType,a.timeout=void 0===a.timeout?1e4:a.timeout,a.success=void 0===a.success?t:a.success,a.error=void 0===a.error?t:a.error,a.complete=void 0===a.complete?t:a.complete;let n=new XMLHttpRequest;n.responseType=a.dataType,n.timeout=a.timeout,n.onload=a.success,n.onerror=a.error,n.onloadend=a.complete,n.open(a.method,a.url,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");let d="",s=0;for(const e in a.data)d+=0===s?e+"="+a.data[e]:"&"+e+"="+a.data[e],s++;n.send(d)}function sendData(e){if(e.preventDefault(),"false"===document.getElementById("send").getAttribute("active"))return!1;if(window.jQuery&&!allFieldsAreValid())return document.getElementById("sendStatusField").innerHTML='<div class="alert alert-danger" role="alert">Проверьте, пожалуйста, что все поля заполнены корректно!</div>',!1;document.getElementById("sendStatusField").innerHTML='<div class="alert alert-primary" role="alert">Сообщение отправляется...</div>';const t=document.getElementById("nameInputAddress").value.trim().substring(0,255),a=document.getElementById("mailInputAddress").value.trim().substring(0,255),n=document.getElementById("subjectInputAddress").value.trim().substring(0,255),d=document.getElementById("messageTextArea").value.trim().substring(0,255);"true"===document.getElementById("send").getAttribute("active")&&0!==t.length&&0!==a.length&&0!==n.length&&0!==d.length?doAJAX({url:"/about/testmail.php?action=send",data:{name:t,email:a,subject:n,textarea:d,grr:grecaptcha.getResponse()},success:function(){JSON.parse(this.response).isvalid?document.getElementById("sendStatusField").innerHTML='<div class="alert alert-success" role="alert">Сообщение отправлено</div>':document.getElementById("sendStatusField").innerHTML='<div class="alert alert-danger" role="alert">Что-то пошло не так! Попробуйте отправить сообщение заново</div>'},error:function(){document.getElementById("sendStatusField").innerHTML='<div class="alert alert-danger" role="alert">Произошла ошибка! Попробуйте отправить сообщение позже</div>'}}):0===t.length&&0!==a.length&&0===n.length&&0!==d.length||(document.getElementById("sendStatusField").innerHTML='<div class="alert alert-danger" role="alert">Проверьте, пожалуйста, что все поля заполнены корректно!</div>')}function init(){document.getElementById("nameInputAddress").value="",document.getElementById("mailInputAddress").value="",document.getElementById("subjectInputAddress").value="",document.getElementById("messageTextArea").value="",showCharLength(),document.getElementById("messageTextArea").addEventListener("keyup",showCharLength),document.getElementById("send").addEventListener("click",sendData),document.getElementById("modalClose").addEventListener("click",(function(){resetForm(),document.getElementById("sendStatusField").innerHTML=""})),document.getElementById("modalOKbutton").addEventListener("click",(function(){resetForm(),document.getElementById("sendStatusField").innerHTML=""}))}document.addEventListener("DOMContentLoaded",init);
